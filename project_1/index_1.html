<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>chat</title>
  </head>
  <body>
    <div>
      <form>
        <input type="text" />
        <button type="submit">전송</button>
      </form>
      <div id="contents"></div>
    </div>

    <script>
      let $input = document.querySelector("input");
      let $button = document.querySelector("button");

      let data = [
        {
          role: "system",
          content:
            "assistant는 요리 전문가이다. 사용자가 재료를 입력하면 그것들로 만들 수 있는 요리를 목록으로 3개 이상 알려준다.",
        },
        {
          role: "user",
          content: "감자",
        },
        {
          role: "assistant",
          content: `감자로 만들 수 있는 다양한 요리가 있습니다. 몇 가지를 소개해드리겠습니다.
          
1. 감자튀김: 감자를 슬라이스해서 노릇하게 튀겨서 소금이나 양념을 뿌려서 드시면 맛있습니다. 간단하지만 깊은 맛을 느낄 수 있는 대표적인 감자 요리입니다.

2. 구운 감자: 감자를 껍질까지 깨끗이 씻고, 껍질은 깨끗한 상태로 유지합니다. 전자레인지나 오븐에서 굽습니다. 구운 감자는 부드럽고 달콤해서 좋습니다.

3. 감자조림: 감자를 끓인 후 고춧가루, 간장, 설탕 등으로 간을 맞추면 매콤하고 달콤한 감자조림이 나옵니다.

4. 감자전: 감자를 다진 후 부침가루와 계란 등으로 만든 반죽에 넣어서 굽습니다. 간단하게 만들어도 맛이 좋습니다.

5. 감자구이: 감자를 토막내서 오븐이나 프라이팬에서 구워줍니다. 소금이나 고추장을 뿌려서 드시면 맛있습니다.

알려드린 방법들 외에도 많은 방법으로 감자를 요리할 수 있습니다. 직접 조리해 보시면 더 맛있는 요리를 만들어 낼 수 있을 것입니다. `,
        },
      ];

      let url = `https://estsoft-openai-api.jejucodingcamp.workers.dev/`;

      $button.addEventListener("click", (e) => {
        e.preventDefault();
        userInputData = $input.value;
        $input.value = "";

        data.push({
          role: "user",
          content: userInputData,
        });
        // 답변 목록도 push를 하면 맥락을 이해하여 답변이 가능합니다.
        // DAY 1, DAY 2, DAY 3와 같은 형식으로 답변해줘라고 미리 학습을 시켜놓으면 split('DAY') 이런 식으로 Card를 만들 수 있습니다.

        chatGptAPI();
      });

      function chatGptAPI() {
        fetch(url, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
          redirect: "follow",
        })
          .then((res) => res.json())
          .then((res) => {
            // console.log(res)
            // console.log(res.choices[0].message.content)
            document.querySelector("#contents").innerText =
              res.choices[0].message.content;
          });
        // 아래 코드는 fetch 성공, 실패, 통신 중 여부와 상관없이 실행됩니다. 비동기에요.
        console.log("hello world");
      }
    </script>
  </body>
</html>
